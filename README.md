# 📈 NanoValue-Momentum Strategy

> 💡 **專案命名由來：**
>
> * **Nano**：代表策略聚焦於市值後 20% 的小型股（Nano-cap），具備成長潛力。
> * **Value**：篩選 P*[P/B] 值最低的 20% 公司，屬於調整後的價值型投資（Value Investing）。
> * **Momentum**：要求近一年報酬率為正，納入動能因子（Momentum Investing）選股邏輯。
>
> 此策略結合三大經典風格：小型股、價值股與動能股，具備多因子篩選特性，故命名為 **NanoValue-Momentum Strategy**。

本專案為一套完整的選股回測架構，涵蓋資料清理、缺值處理、選股邏輯、回測程式碼與視覺化報表輸出。

> ✅ **重點特色：**
>
> * 附有 **Jupyter Notebook** 範例，完整呈現資料處理過程
> * 可產生 **HTML 報表**，內含累積報酬、熱力圖、最大回徹等圖表
> * 股票池僅包含 **上市（含已下市）普通股**，排除 TDR、KY 股，**有效避免僅存者偏差**

---

## 📁 專項結構

```
project/
🔹 Data_Process/             # 原始資料、處理過程的ipynb檔以及處理後的 .pkl 檔
🔹 Backtest_Data.pkl         # 整理好資料，統整成pkl比較好看
🔹 Backtest.ipynb            # 主程式回測程式碼
🔹 performance_report.html   # 回測後輸出結果
```

---

## 🧹 資料處理流程

### 一、公司股價資料處理

* NaN 表示其當下資料缺乏，缺值以 `0` 取代。
* 缺值具備經濟意義並利於排序與建模。
* 搭配調整後價值因子有高成長性。
* 儲存為 `.pkl` 格式以加快讀取速度。

### 二、技術面資料處理

* NaN 表示公司成立未滿一個月，保留以利後續直接dropna掉。
* 去除原因：公司上市初期股價異動大，技術指標易失真。

### 三、報酬率資料處理

* 無缺值；若公司成立時間太短，則直接缺值。
* 合併時若為 NaN，代表資料不足或已下市，直接透過補 `0`來表示資料缺乏。

### 四、合併資料流程

1. 價格 + 技術 → 刪除含 NaN 的資料列
2. 合併「近一年報酬率 %」 → 作為動能因子，若為 NaN 表示公司上市不夠久。
3. 合併「近一月報酬率 %」 → 作為持有後報酬，若 NaN (公司下市)視為報酬率 0。

---

## 🧬 選股邏輯（四層篩選）

> 每月進行一次選股與回測，邏輯如下：

1️⃣ **價格篩選**：收盤價 > 10 元，排除雞蛋水餃股

2️⃣ **規模篩選**：市值後 20% (小型股，未來成長性高)

3️⃣ **調整後價值因子**：P*[P/B] 後 20% (低股價淨值比)

4️⃣ **動能因子**：近 12 月報酬 > 0 (強者恆強)

---

## 📊 回測結果視覺化

> 所有圖表皆存於 HTML 報表中，直接於瀏覽器查看。

### 📈 累積報酬

* 線圖，呈現資產增長趨勢

### 🌡️ 月報酬熱力圖

* 用色階顯示每年每月策略績效強弱

### 📉 回擊圖 (Drawdown)

* 視覺化最大資產回擊期間與幅度

---

## 🧰 執行方式

### ✅ 安裝必要套件

```bash
pip install pandas matplotlib seaborn ffn
```

### ✅ 執行主程式

```bash
Backtest.ipynb 
```

### ✅ 查看報表

輸出為：

```
performance_report.html
```

---


## ⚠️ 注意事項

* 僅管管於「上市普通股（含已下市）」 → **避免僅存者偏差**
* 策略未組入交易成本、滑價與風控等現實因素
* 僅供學術研究與策略驗證參考，**非投資建議**

---

## 🤝 貢獻與討論

歡迎提出 issue 或 pull request，一起優化回測邏輯與視覺化報表 🙌
也可用於其他風格因子策略（如成長股、反轉股等）延伸應用！

---
